<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Îã¨ÌÜ†ÎÅº Î≤®Î£®ÎÇò - WEEKLY SCHEDULE</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jua&family=Nunito:wght@600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

  <style>
    :root{
      --w: 1920px;
      --h: 1080px;

      /* Vell Luna vibe */
      --ink: #2f2a3a;
      --soft: rgba(47,42,58,.72);
      --glass: rgba(255,255,255,.70);
      --glass2: rgba(255,255,255,.54);
      --stroke: rgba(64,55,92,.18);

      --moon: rgba(255,255,255,.75);
      --violet: rgba(179,156,255,.60);
      --mint: rgba(127,230,200,.52);
      --pink: rgba(255,214,240,.45);

      --shadow: 0 18px 45px rgba(30,20,60,.16);
      --radius: 28px;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      background:#0b0b12;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
      font-family:"Nunito",system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
      color: var(--ink);
    }

    /* capture target */
    #capture{
      width: var(--w);
      height: var(--h);
      position:relative;
      overflow:hidden;
      border-radius: 34px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(255,255,255,.28);
      background:
        radial-gradient(1200px 900px at 12% 20%, var(--violet), transparent 62%),
        radial-gradient(900px 700px at 88% 28%, var(--mint), transparent 60%),
        radial-gradient(900px 700px at 55% 100%, var(--pink), transparent 56%),
        linear-gradient(135deg, #f5f2ff, #e9fff7);
    }

    /* starfield */
    .stars{
      position:absolute; inset:-80px;
      background-image:
        radial-gradient(circle at 12% 18%, rgba(255,255,255,.9) 0 2px, transparent 3px),
        radial-gradient(circle at 28% 55%, rgba(255,255,255,.7) 0 1.5px, transparent 3px),
        radial-gradient(circle at 52% 22%, rgba(255,255,255,.75) 0 2px, transparent 3px),
        radial-gradient(circle at 68% 42%, rgba(255,255,255,.65) 0 1.2px, transparent 3px),
        radial-gradient(circle at 84% 16%, rgba(255,255,255,.8) 0 1.8px, transparent 3px),
        radial-gradient(circle at 90% 72%, rgba(255,255,255,.65) 0 1.4px, transparent 3px),
        radial-gradient(circle at 18% 82%, rgba(255,255,255,.6) 0 1.2px, transparent 3px);
      opacity:.36;
      filter: blur(.25px);
      pointer-events:none;
    }

    /* aurora ribbons */
    .aurora{
      position:absolute; inset:-60px;
      background:
        radial-gradient(800px 240px at 20% 30%, rgba(127,230,200,.28), transparent 70%),
        radial-gradient(820px 260px at 55% 35%, rgba(179,156,255,.22), transparent 72%),
        radial-gradient(880px 280px at 80% 42%, rgba(255,214,240,.18), transparent 72%);
      transform: rotate(-6deg);
      opacity:.85;
      pointer-events:none;
      filter: blur(1px);
    }

    /* big moon + bunny silhouette */
    .moon{
      position:absolute;
      width: 520px; height:520px;
      right: 88px; top: 72px;
      border-radius: 50%;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.98), rgba(255,255,255,.70) 46%, rgba(255,255,255,.20) 72%, transparent 74%),
        radial-gradient(circle at 70% 65%, rgba(179,156,255,.22), transparent 58%);
      box-shadow: 0 24px 70px rgba(179,156,255,.25);
      opacity:.92;
      pointer-events:none;
    }
    .moon:after{
      content:"";
      position:absolute;
      width: 240px; height: 240px;
      right: 105px; bottom: 78px;
      background: rgba(47,42,58,.14);
      border-radius: 130px 130px 90px 90px;
      transform: rotate(-12deg);
      clip-path: polygon(10% 38%, 30% 14%, 48% 8%, 70% 14%, 90% 38%, 94% 62%, 82% 86%, 50% 93%, 18% 86%, 6% 62%);
      opacity:.36;
      filter: blur(.15px);
    }

    /* layout */
    .wrap{
      position:absolute;
      inset: 70px 64px 64px 64px;
      display:grid;
      grid-template-columns: 1.10fr .90fr;
      gap: 34px;
      align-items: stretch;
    }

    .card{
      background: var(--glass);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: 0 12px 30px rgba(45,30,80,.08);
      backdrop-filter: blur(10px);
    }

    /* left schedule */
    .left{ padding: 34px 34px 28px 34px; position:relative; overflow:hidden; }
    .title{
      display:flex;
      align-items:flex-end;
      gap:14px;
      margin-bottom: 10px;
    }
    .title h1{
      font-family:"Jua", sans-serif;
      font-size: 78px;
      margin:0;
      line-height:1;
      letter-spacing: 1px;
      text-shadow: 0 3px 0 rgba(255,255,255,.55);
    }
    .badge{
      font-weight: 900;
      font-size: 18px;
      padding: 10px 14px;
      border-radius: 999px;
      background: linear-gradient(90deg, rgba(179,156,255,.42), rgba(127,230,200,.32));
      border: 1px solid rgba(179,156,255,.24);
      color: rgba(47,42,58,.78);
      white-space:nowrap;
    }
    .sub{
      margin: 8px 0 0;
      color: var(--soft);
      font-size: 18px;
    }

    .rows{
      margin-top: 22px;
      display:flex;
      flex-direction:column;
      gap: 14px;
    }
    .row{ display:grid; grid-template-columns: 140px 1fr; gap: 14px; align-items:center; }
    .day{
      font-weight: 900;
      font-size: 22px;
      letter-spacing: .6px;
      padding: 14px 16px;
      border-radius: 999px;
      background: rgba(255,255,255,.58);
      border: 1px solid rgba(64,55,92,.14);
      box-shadow: 0 8px 18px rgba(45,30,80,.06);
      text-align:center;
    }
    .input{
      min-height: 58px;
      padding: 14px 18px;
      border-radius: 22px;
      border: 1px solid rgba(64,55,92,.14);
      outline:none;
      font-size: 22px;
      color: rgba(47,42,58,.92);
      box-shadow: 0 8px 18px rgba(45,30,80,.06);
      display:flex;
      align-items:center;
      background: rgba(255,255,255,.66);
    }
    .input[contenteditable="true"]:empty:before{
      content: attr(data-placeholder);
      color: rgba(47,42,58,.35);
    }
    .row:nth-child(even) .input{ background: rgba(245,245,255,.68); }

    .spark{
      position:absolute;
      width: 300px; height: 300px;
      left: -110px; bottom: -120px;
      background:
        radial-gradient(circle at 30% 30%, rgba(127,230,200,.70), transparent 62%),
        radial-gradient(circle at 70% 60%, rgba(179,156,255,.60), transparent 64%);
      filter: blur(2px);
      opacity: .55;
      pointer-events:none;
    }

    /* right panel */
    .right{ padding: 26px; display:flex; flex-direction:column; gap: 14px; position:relative; overflow:hidden; }
    .frame{
      flex: 1;
      border-radius: 34px;
      background:
        linear-gradient(180deg, rgba(255,255,255,.82), rgba(255,255,255,.48)),
        radial-gradient(700px 400px at 20% 10%, rgba(255,214,240,.30), transparent 55%);
      border: 2px solid rgba(179,156,255,.28);
      box-shadow: 0 14px 30px rgba(45,30,80,.08);
      position:relative;
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    #photo{
      width:100%;
      height:100%;
      object-fit: cover;
      display:none;
    }
    .hint{
      position:absolute;
      left:18px; right:18px; bottom:18px;
      font-size: 18px;
      color: rgba(47,42,58,.55);
      background: rgba(255,255,255,.55);
      border: 1px dashed rgba(64,55,92,.18);
      border-radius: 18px;
      padding: 10px 12px;
      text-align:center;
    }
    .watermark{
      position:absolute;
      top: 16px; right: 16px;
      font-weight: 900;
      letter-spacing: .8px;
      font-size: 16px;
      padding: 10px 14px;
      border-radius: 999px;
      color: rgba(47,42,58,.76);
      background: rgba(255,255,255,.55);
      border: 1px solid rgba(64,55,92,.14);
      backdrop-filter: blur(8px);
    }

    .picker{
      background: var(--glass2);
      border: 1px solid var(--stroke);
      border-radius: 22px;
      padding: 12px;
    }
    .pickerTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 10px;
    }
    .pickerTop .label{
      font-weight: 900;
      color: rgba(47,42,58,.78);
      display:flex;
      align-items:center;
      gap:10px;
    }
    .chip{
      font-size: 13px;
      font-weight: 900;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(179,156,255,.22);
      background: linear-gradient(90deg, rgba(179,156,255,.18), rgba(127,230,200,.14));
      color: rgba(47,42,58,.70);
      white-space:nowrap;
    }
    .thumbGrid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }
    .thumb{
      position:relative;
      border-radius: 18px;
      border: 1px solid rgba(64,55,92,.16);
      overflow:hidden;
      background: rgba(255,255,255,.60);
      cursor:pointer;
      aspect-ratio: 1 / 1;
      box-shadow: 0 8px 18px rgba(45,30,80,.05);
      transform: translateZ(0);
    }
    .thumb img{
      width:100%; height:100%;
      object-fit: cover;
      display:block;
      filter: saturate(1.02);
    }
    .thumb .cap{
      position:absolute;
      left: 10px; right: 10px; bottom: 10px;
      font-size: 12px;
      font-weight: 900;
      color: rgba(47,42,58,.86);
      background: rgba(255,255,255,.60);
      border: 1px solid rgba(64,55,92,.12);
      padding: 6px 8px;
      border-radius: 999px;
      text-align:center;
      backdrop-filter: blur(8px);
    }
    .thumb.selected{
      outline: 3px solid rgba(179,156,255,.55);
      box-shadow: 0 14px 26px rgba(179,156,255,.18);
    }

    .tools{
      display:flex;
      gap: 10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }
    .tools .leftTools{
      display:flex; gap: 10px; flex-wrap:wrap; align-items:center;
    }
    .btn, select, .filebtn{
      appearance:none;
      border: 1px solid rgba(255,255,255,.22);
      background: rgba(20,18,30,.72);
      color: rgba(255,255,255,.92);
      padding: 12px 14px;
      border-radius: 14px;
      font-weight: 900;
      cursor:pointer;
      backdrop-filter: blur(10px);
      display:inline-flex;
      align-items:center;
      gap:10px;
    }
    .btn:hover, select:hover, .filebtn:hover{ background: rgba(20,18,30,.82); }
    input[type="file"]{ display:none; }

    .toast{
      position: fixed;
      right: 18px; bottom: 18px;
      background: rgba(20,18,30,.78);
      color: rgba(255,255,255,.9);
      padding: 12px 14px;
      border-radius: 14px;
      font-weight: 900;
      opacity:0;
      transform: translateY(8px);
      transition: .22s ease;
      z-index: 10000;
      pointer-events:none;
    }
    .toast.show{ opacity:1; transform: translateY(0); }

    /* capture mode: hide UI inside right panel that shouldn't appear */
    body.capturing .noCapture, body.capturing .toast{ display:none !important; }
  </style>
</head>

<body>
  <div id="capture" aria-label="schedule-canvas">
    <div class="stars"></div>
    <div class="aurora"></div>
    <div class="moon"></div>

    <div class="wrap">
      <section class="card left">
        <div class="spark"></div>

        <div class="title">
          <h1>SCHEDULE</h1>
          <div class="badge">Îã¨ÌÜ†ÎÅº Î≤®Î£®ÎÇò</div>
        </div>
        <div class="sub">ÌÅ¥Î¶≠Ìï¥ÏÑú Ï†ÅÍ≥†, Ïò§Î•∏Ï™ΩÏóêÏÑú Ï∫êÎ¶≠ÌÑ∞ ÏÑ†ÌÉù ÌõÑ JPG Ï†ÄÏû• ‚ú®</div>

        <div class="rows" id="rows"></div>
      </section>

      <section class="card right">
        <div class="frame">
          <img id="photo" alt="character" />
          <div class="watermark">Vell Luna ‚Ä¢ Weekly</div>
          <div class="hint" id="hint">ÏïÑÎûò Ïç∏ÎÑ§ÏùºÏóêÏÑú Ï∫êÎ¶≠ÌÑ∞ ÏÑ†ÌÉù ÎòêÎäî ‚ÄòÏù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú‚ÄôÎ•º ÏÇ¨Ïö©Ìï¥Ï§ò</div>
        </div>

        <!-- thumbnail picker -->
        <div class="picker noCapture">
          <div class="pickerTop">
            <div class="label">üéÄ Ï∫êÎ¶≠ÌÑ∞ ÎØ∏Î¶¨Î≥¥Í∏∞ ÏÑ†ÌÉù <span class="chip">assets/thumbs</span></div>
            <div class="tools">
              <div class="leftTools">
                <label class="filebtn" for="fileImg">üñºÔ∏è Ïù¥ÎØ∏ÏßÄ ÏóÖÎ°úÎìú</label>
                <input id="fileImg" type="file" accept="image/*" />
                <select id="fitMode" title="Ïù¥ÎØ∏ÏßÄ ÎßûÏ∂§">
                  <option value="cover" selected>ÍΩâ Ï±ÑÏö∞Í∏∞(cover)</option>
                  <option value="contain">Ï†ÑÏ≤¥ Î≥¥Ïù¥Í∏∞(contain)</option>
                </select>
                <select id="sizePreset" title="Ìï¥ÏÉÅÎèÑ">
                  <option value="1920x1080" selected>1920√ó1080</option>
                  <option value="1280x720">1280√ó720</option>
                </select>
              </div>
              <button class="btn" id="btnClearImg">üßº Ïù¥ÎØ∏ÏßÄ Ï†úÍ±∞</button>
            </div>
          </div>

          <div class="thumbGrid" id="thumbGrid"></div>
        </div>

        <div class="tools noCapture" style="margin-top:6px;">
          <button class="btn" id="btnExport">üì∏ JPGÎ°ú Ï†ÄÏû•</button>
          <button class="btn" id="btnClear">üóëÔ∏è Ïä§ÏºÄÏ§Ñ Ï¥àÍ∏∞Ìôî</button>
        </div>
      </section>
    </div>
  </div>

  <div class="toast" id="toast">Ï†ÄÏû• ÏôÑÎ£å!</div>

<script>
  const DAYS = [
    { key:"mon", label:"MON" },
    { key:"tue", label:"TUE" },
    { key:"wed", label:"WED" },
    { key:"thu", label:"THU" },
    { key:"fri", label:"FRI" },
    { key:"sat", label:"SAT" },
    { key:"sun", label:"SUN" },
  ];

  // Preset character list (add more by dropping files into assets/thumbs & assets)
  const PRESETS = [
    { id:"velluna_01", name:"Î≤®Î£®ÎÇò 01", full:"assets/velluna_01.png", thumb:"assets/thumbs/velluna_01.png" },
    { id:"velluna_02", name:"Î≤®Î£®ÎÇò 02", full:"assets/velluna_02.png", thumb:"assets/thumbs/velluna_02.png" },
    { id:"velluna_03", name:"Î≤®Î£®ÎÇò 03", full:"assets/velluna_03.png", thumb:"assets/thumbs/velluna_03.png" },
  ];

  const LS_KEY = "velluna_schedule_v2";
  const LS_IMG = "velluna_schedule_img_v2";
  const LS_PRESET = "velluna_schedule_preset_v2";
  const LS_FIT = "velluna_schedule_fit_v2";
  const LS_SIZE = "velluna_schedule_size_v2";

  const rowsEl = document.getElementById("rows");
  const toastEl = document.getElementById("toast");
  const photoEl = document.getElementById("photo");
  const hintEl = document.getElementById("hint");
  const gridEl = document.getElementById("thumbGrid");

  function showToast(msg){
    toastEl.textContent = msg;
    toastEl.classList.add("show");
    setTimeout(()=>toastEl.classList.remove("show"), 1200);
  }

  function loadJSON(key, fallback){
    try{ return JSON.parse(localStorage.getItem(key) || JSON.stringify(fallback)); }
    catch(e){ return fallback; }
  }

  function saveJSON(key, value){
    localStorage.setItem(key, JSON.stringify(value));
  }

  function buildRows(){
    const data = loadJSON(LS_KEY, {});
    rowsEl.innerHTML = "";
    for(const d of DAYS){
      const row = document.createElement("div");
      row.className = "row";

      const day = document.createElement("div");
      day.className = "day";
      day.textContent = d.label;

      const input = document.createElement("div");
      input.className = "input";
      input.contentEditable = "true";
      input.spellcheck = false;
      input.dataset.key = d.key;
      input.dataset.placeholder = "Ïòà) 21:00 Î∞∞Í∑∏ / 23:00 Ï¢ÖÍ≤ú / ÏÜåÌÜµ";
      input.textContent = data[d.key] || "";

      input.addEventListener("input", ()=>{
        const latest = loadJSON(LS_KEY, {});
        latest[d.key] = input.textContent.trim();
        saveJSON(LS_KEY, latest);
      });

      row.appendChild(day);
      row.appendChild(input);
      rowsEl.appendChild(row);
    }
  }

  function setSizePreset(value){
    if(value === "1280x720"){
      document.documentElement.style.setProperty("--w", "1280px");
      document.documentElement.style.setProperty("--h", "720px");
    }else{
      document.documentElement.style.setProperty("--w", "1920px");
      document.documentElement.style.setProperty("--h", "1080px");
    }
    localStorage.setItem(LS_SIZE, value);
  }

  function setFit(value){
    photoEl.style.objectFit = value;
    localStorage.setItem(LS_FIT, value);
  }

  function applyImage(src){
    photoEl.crossOrigin = "anonymous";
    photoEl.src = src;
    photoEl.style.display = "block";
    hintEl.style.display = "none";
  }

  function clearSelectedThumb(){
    gridEl.querySelectorAll(".thumb").forEach(t=>t.classList.remove("selected"));
  }

  function selectPreset(presetId){
    const p = PRESETS.find(x=>x.id === presetId);
    if(!p) return;
    clearSelectedThumb();
    const btn = gridEl.querySelector(`[data-id="${presetId}"]`);
    if(btn) btn.classList.add("selected");
    localStorage.setItem(LS_PRESET, presetId);
    localStorage.removeItem(LS_IMG); // preset wins over uploaded image
    applyImage(p.full);
    showToast("Ï∫êÎ¶≠ÌÑ∞ Ï†ÅÏö©!");
  }

  function buildThumbs(){
    gridEl.innerHTML = "";
    PRESETS.forEach(p=>{
      const item = document.createElement("button");
      item.type = "button";
      item.className = "thumb";
      item.dataset.id = p.id;
      item.innerHTML = `<img alt="${p.name}" src="${p.thumb}"/><div class="cap">${p.name}</div>`;
      item.addEventListener("click", ()=> selectPreset(p.id));
      gridEl.appendChild(item);
    });
  }

  // upload image
  document.getElementById("fileImg").addEventListener("change", (e)=>{
    const file = e.target.files?.[0];
    if(!file) return;
    const reader = new FileReader();
    reader.onload = () => {
      const dataUrl = reader.result;
      clearSelectedThumb();
      localStorage.removeItem(LS_PRESET);
      localStorage.setItem(LS_IMG, dataUrl);
      applyImage(dataUrl);
      showToast("ÏóÖÎ°úÎìú Ïù¥ÎØ∏ÏßÄ Ï†ÅÏö©!");
    };
    reader.readAsDataURL(file);
    e.target.value = "";
  });

  // fit mode
  document.getElementById("fitMode").addEventListener("change",(e)=>{
    setFit(e.target.value);
    showToast("ÎßûÏ∂§ Î≥ÄÍ≤Ω!");
  });

  // size preset
  document.getElementById("sizePreset").addEventListener("change",(e)=>{
    setSizePreset(e.target.value);
    showToast("Ìï¥ÏÉÅÎèÑ Î≥ÄÍ≤Ω!");
  });

  // clear schedule
  document.getElementById("btnClear").addEventListener("click", ()=>{
    localStorage.removeItem(LS_KEY);
    buildRows();
    showToast("Ïä§ÏºÄÏ§Ñ Ï¥àÍ∏∞Ìôî!");
  });

  // clear image
  document.getElementById("btnClearImg").addEventListener("click", ()=>{
    localStorage.removeItem(LS_IMG);
    localStorage.removeItem(LS_PRESET);
    photoEl.removeAttribute("src");
    photoEl.style.display = "none";
    hintEl.style.display = "block";
    clearSelectedThumb();
    showToast("Ïù¥ÎØ∏ÏßÄ Ï†úÍ±∞!");
  });

  // export JPG
  document.getElementById("btnExport").addEventListener("click", async ()=>{
    const captureEl = document.getElementById("capture");
    document.body.classList.add("capturing");
    await new Promise(r => setTimeout(r, 120)); // settle

    const rect = captureEl.getBoundingClientRect();
    const scale = 2;

    const canvas = await html2canvas(captureEl, {
      backgroundColor: null,
      useCORS: true,
      scale,
      width: rect.width,
      height: rect.height,
      windowWidth: rect.width,
      windowHeight: rect.height,
    });

    document.body.classList.remove("capturing");

    const url = canvas.toDataURL("image/jpeg", 0.95);
    const a = document.createElement("a");
    a.href = url;
    a.download = "velluna_schedule.jpg";
    a.click();
    showToast("JPG Ï†ÄÏû• ÏôÑÎ£å!");
  });

  // init
  buildRows();
  buildThumbs();

  // restore fit/size
  const savedFit = localStorage.getItem(LS_FIT) || "cover";
  document.getElementById("fitMode").value = savedFit;
  setFit(savedFit);

  const savedSize = localStorage.getItem(LS_SIZE) || "1920x1080";
  document.getElementById("sizePreset").value = savedSize;
  setSizePreset(savedSize);

  // restore image (uploaded wins if exists, else preset)
  const savedImg = localStorage.getItem(LS_IMG);
  const savedPreset = localStorage.getItem(LS_PRESET);

  if(savedImg){
    applyImage(savedImg);
  }else if(savedPreset){
    selectPreset(savedPreset);
  }
</script>
</body>
</html>
